
## Playbooks

**Running userspace crash demo:**
```bash
$ make
$ make user-nullderef-run
$ coredumpctl debug
```

**Running kernel nullderef crash demo:**
```bash
$ pwd
/home/fred/Presentations/cve-noqueue-no-problem
$ make CRASH=1
$ make vm
... VM boots up ...
$ make kernel-nullderef-run
```

**Running exploit kernel demo:**
```bash
$ make
$ make vm
$ ./exploit.sh
```

**Determining application capabilities:**

```bash
$ find / -executable -iname tc 2>/dev/null
/usr/sbin/tc
$ sudo capable | grep tc
18:56:00 1000  127888  tc               12      CAP_NET_ADMIN        1       deny
```

In another terminal:
```bash
$ /sbin/tc qdisc add dev docker0
RTNETLINK answers: Operation not permitted
```

## Links

### Additional reading
1. [Blog post](https://blog.cloudflare.com/cve-2022-47929-traffic-control-noqueue-no-problem)
1. [CVE-2022-47929](https://nvd.nist.gov/vuln/detail/CVE-2022-47929)

### Tools used
* [coredumpctl(1)](https://man7.org/linux/man-pages/man1/coredumpctl.1.html)
* [dmesg(1)](https://man7.org/linux/man-pages/man1/dmesg.1.html)
* [docker](https://www.docker.com/)
* [gdb(1)](https://man7.org/linux/man-pages/man1/gdb.1.html)
* [ip(8)](https://man7.org/linux/man-pages/man8/ip.8.html)
* [libbpf-tools](https://github.com/iovisor/bcc/tree/master/libbpf-tools)
* [namespaces(7)](https://man7.org/linux/man-pages/man7/namespaces.7.html)
* [strace(1)](https://man7.org/linux/man-pages/man1/strace.1.html)
* [tc(8)](https://man7.org/linux/man-pages/man8/tc.8.html)
* [unshare(1)](https://man7.org/linux/man-pages/man1/unshare.1.html)
* [virtme-ng](https://github.com/arighi/virtme-ng)
